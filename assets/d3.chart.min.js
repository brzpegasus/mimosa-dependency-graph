/*! d3.chart - v0.1.1
 *  License: MIT Expat
 *  Date: 2013-06-10
 */
(function(t){"use strict";var n=t.d3,e={noBase:Error("d3.layer must be initialized with a base"),noDataBind:Error("d3.layer must specify a `dataBind` method."),noInsert:Error("d3.layer must specify an `insert` method.")},r=function(t){if(!t)throw e.noBase;this._base=t,this._handlers={}};r.prototype.dataBind=function(){throw e.noDataBind},r.prototype.insert=function(){throw e.noInsert},r.prototype.on=function(t,n,e){e=e||{},t in this._handlers||(this._handlers[t]=[]),this._handlers[t].push({callback:n,chart:e.chart||null})},r.prototype.off=function(t,n){var e,r=this._handlers[t];if(r){if(1===arguments.length)return r.length=0,undefined;for(e=r.length-1;e>-1;--e)r[e].callback===n&&r.splice(e,1)}},r.prototype.draw=function(t){var e,r,i,s,o,a,h,c;if(e=this.dataBind.call(this._base,t),!(e instanceof n.selection))throw Error("Invalid selection defined by `dataBind` method.");r=e.enter(),r._chart=this._base._chart,i=[{name:"update",selection:e},{name:"enter",selection:this.insert.bind(r)},{name:"merge",selection:e},{name:"exit",selection:e.exit.bind(e)}];for(var l=0,u=i.length;u>l;++l){if(a=i[l].name,s=i[l].selection,"function"==typeof s&&(s=s()),!(s instanceof n.selection))throw Error('Invalid selection defined for "'+a+"' lifecycle event.");if(o=this._handlers[a])for(h=0,c=o.length;c>h;++h)s._chart=o[h].chart||this._base._chart,s.call(o[h].callback);if(o=this._handlers[a+":transition"],o&&o.length)for(s=s.transition(),h=0,c=o.length;c>h;++h)s._chart=o[h].chart||this._base._chart,s.call(o[h].callback)}},n.selection.prototype.layer=function(t){var n,e=new r(this);if(e.dataBind=t.dataBind,e.insert=t.insert,"events"in t)for(n in t.events)e.on(n,t.events[n]);return this.on=function(){return e.on.apply(e,arguments)},this.off=function(){return e.off.apply(e,arguments)},this.draw=function(){return e.draw.apply(e,arguments)},this}})(this),function(t,n){"use strict";function e(t){var n,e,r,i;if(!t)return t;for(e=arguments.length,n=1;e>n;n++)if(r=arguments[n])for(i in r)t[i]=r[i];return t}var r=t.d3,i=function(t){this.constructor=t},s=function(t,n){var e;return i.prototype=t.prototype,e=new i(t),t.apply(e,n),e},o=function(t,n){var e=this.constructor.__super__;e&&o.call(e,t,n),Object.hasOwnProperty.call(this.constructor.prototype,"initialize")&&this.initialize.apply(t,n)},a=function(t){this.base=t,this._layers={},this._mixins=[],this._events={},o.call(this,this,Array.prototype.slice.call(arguments,1))};a.prototype.unlayer=function(t){var n=this.layer(t),e=this._layerList.indexOf(n);return delete this._layers[t],this._layerList.splice(e,1),this},a.prototype.layer=function(t,n,e){var r;return 1===arguments.length?this._layers[t]:(r=n.layer(e),this._layers[t]=r,n._chart=this,r)},a.prototype.initialize=function(){},a.prototype.transform=function(t){return t},a.prototype.mixin=function(t,n){var e=Array.prototype.slice.call(arguments,2);e.unshift(n);var r=a[t],i=s(r,e);return this._mixins.push(i),i},a.prototype.draw=function(t){var n,e;t=this.transform(t);for(n in this._layers)this._layers[n].draw(t);for(e in this._mixins)this._mixins[e].draw(t)},a.prototype.on=function(t,n,e){var r=this._events[t]||(this._events[t]=[]);return r.push({callback:n,context:e||this,_chart:this}),this},a.prototype.once=function(t,n,e){var r=this,i=function(){r.off(t,i),n.apply(this,arguments)};return this.on(t,i,e)},a.prototype.off=function(t,n,e){var r,i,s,o,a,h;if(0===arguments.length){for(t in this._events)this._events[t].length=0;return this}if(1===arguments.length)return s=this._events[t],s&&(s.length=0),this;for(r=t?[t]:Object.keys(this._events),a=0;r.length>a;a++)for(i=r[a],s=this._events[i],h=s.length;h--;)o=s[h],(n&&n===o.callback||e&&e===o.context)&&s.splice(h,1);return this},a.prototype.trigger=function(t){var e,r,i=Array.prototype.slice.call(arguments,1),s=this._events[t];if(s!==n)for(e=0;s.length>e;e++)r=s[e],r.callback.apply(r.context,i);return this},a.extend=function(t,n,r){var i,s=this;i=n&&Object.hasOwnProperty.call(n,"constructor")?n.constructor:function(){return s.apply(this,arguments)},e(i,s,r);var o=function(){this.constructor=i};return o.prototype=s.prototype,i.prototype=new o,n&&e(i.prototype,n),i.__super__=s.prototype,a[t]=i,i},r.chart=function(t){return 0===arguments.length?a:1===arguments.length?a[t]:a.extend.apply(a,arguments)},r.selection.prototype.chart=function(t){if(0===arguments.length)return this._chart;var n=Array.prototype.slice.call(arguments,1);n.unshift(this);var e=a[t];return s(e,n)},r.selection.enter.prototype.chart=function(){return this._chart},r.transition.prototype.chart=r.selection.enter.prototype.chart}(this);